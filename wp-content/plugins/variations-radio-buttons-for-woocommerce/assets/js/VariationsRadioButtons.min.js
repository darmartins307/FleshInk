(function(t,e,i,a){var r=function(t,e){this.form=t,this.fields=this.form.find(".variations input[type=radio],.variations select"),this.variationData=this.form.data("product_variations"),this.useAjax=!1===this.variationData,this.init(e)};r.prototype.init=function(t){var e=Object.getPrototypeOf(t);r.prototype.findMatchingVariations=e.findMatchingVariations,r.prototype.isMatch=e.isMatch,r.prototype.addSlashes=e.addSlashes,e.isMatch=r.prototype.isMatch,this.useAjax=t.useAjax;var i=this;this.form.off("click.wc-variation-form",".reset_variations"),this.form.off("change.wc-variation-form",".variations select"),this.form.off("update_variation_values.wc-variation-form"),this.form.on("click.wc-variation-form",".reset_variations",function(t){i.onReset(t)}),this.form.on("change.wc-variation-form",".variations input[type=radio],.variations select",function(t){i.onChange(t)}),this.form.on("update_variation_values.wc-variation-form",function(t){i.onUpdateAttributes(t)}),setTimeout(function(){i.form.trigger("check_variations",i.getChosenAttributes())},100)},r.prototype.onReset=function(t){t.preventDefault(),this.fields.removeAttr("disabled checked"),this.fields.parents("label").removeClass("disabled checked"),this.fields.filter("select").val(""),this.fields.find(":first").change(),this.form.trigger("reset_data")},r.prototype.onChange=function(t){this.syncLabelClass(this.getAttributeName(jQuery(t.target))),this.form.find('input[name="variation_id"], input.variation_id').val("").change(),this.form.find(".wc-no-matching-variations").remove();var e=this.getChosenAttributes();this.useAjax?this.form.trigger("check_variations",e):(this.form.trigger("woocommerce_variation_select_change"),this.form.trigger("check_variations",e)),this.form.trigger("woocommerce_variation_has_changed")},r.prototype.getMatchingOptionElements=function(e,i,a){var r=t();for(var s in a)if(void 0!==a[s]&&a[s].variation_is_active){var o=a[s].attributes;if(o.hasOwnProperty(i)){var n=t("<div/>").html(o[i]).text();if(n.length>0){var c=e.filter('[value="'+this.addSlashes(n)+'"]');r=r.add(c)}else r=r.add(e)}}return r},r.prototype.updateRadioOptions=function(e,i,a){if(!e.hasClass("handled")&&e.is("input[type=radio]")){var r=this.getAttributeName(e),s=this.getFields(r),o=s.filter(":checked").attr("value")||"";s.removeAttr("disabled checked"),s.parents("label").removeClass("disabled checked"),s.addClass("handled");var n=t.extend(!0,{},i);n[r]="";var c=this.findMatchingVariations(this.variationData,n);if(c.length>0){if(a>1){var l=this.getMatchingOptionElements(s,r,c),d=s.not(l);d.attr("disabled","disabled"),d.parents("label").addClass("disabled")}var h=s.filter('[value="'+this.addSlashes(o)+'"]');h.prop("checked","checked"),h.parents("label").addClass("checked")}}},r.prototype.syncLabelClass=function(t){this.getFields(t).each(function(){var t=jQuery(this),e=t.parents("label");t.is(":checked")?e.addClass("checked"):e.removeClass("checked")})},r.prototype.getFields=function(t){var e=this.addSlashes(t),i=this.fields.filter('[data-attribute_name="'+e+'"]');return 0==i.length&&(i=this.fields.filter('[name="'+e+'"]')),i},r.prototype.updateSelectOptions=function(e,i,a){if(!e.hasClass("handled")&&e.is("select")){var r=this.getAttributeName(e),s=e.val()||"";if(!e.data("attribute_html")){var o=e.clone();o.find("option").removeClass("attached enabled").removeAttr("disabled selected"),e.data("attribute_html",o.html())}e.html(e.data("attribute_html")),e.addClass("handled");var n=t.extend(!0,{},i);n[r]="";var c=this.findMatchingVariations(this.variationData,n);if(c.length>0){var l=e.find("option");if(a>1){var d=this.getMatchingOptionElements(l,r,c);l.filter("option:gt(0)").not(d).remove(),l=e.find("option")}var h=l.filter('[value="'+this.addSlashes(s)+'"]');h.prop("selected","selected"),h.addClass("attached enabled")}}},r.prototype.onUpdateAttributes=function(e){if(!this.useAjax){var i=this,a=this.getChosenAttributes(),r=a.data,s=a.count;this.fields.removeClass("handled"),this.fields.each(function(e,a){var o=t(a);o.is("input[type=radio]")?i.updateRadioOptions(o,r,s):o.is("select")&&i.updateSelectOptions(o,r,s)}),this.form.trigger("woocommerce_update_variation_values")}},r.prototype.getAttributeName=function(t){return t.data("attribute_name")||t.attr("name")},r.prototype.getChosenAttributes=function(){var e=this,i={},a=0,r=0;return this.fields.each(function(){var s=t(this),o=e.getAttributeName(s),n=s.val()||"";void 0===i[o]&&(i[o]="",a++);var c=!1;s.is("input[type=radio]:checked")?c=!0:s.is("select")&&n.length>0&&(c=!0),c&&(r++,i[o]=n)}),{count:a,chosenCount:r,data:i}},t.fn.wc_variations_image_update=function(a){var s=this,o=s.closest(".product"),n=o.find(".images"),c=o.find(".flex-control-nav"),l=c.find("li:eq(0) img"),d=n.find(".woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder"),h=d.find(".wp-post-image"),_=d.find("a").eq(0);if(a&&a.image&&a.image.src&&a.image.src.length>1){var f=c.find('li img[data-o_src="'+a.image.gallery_thumbnail_src+'"]').length>0;f&&s.wc_variations_image_reset();var g=c.find('li img[src="'+a.image.gallery_thumbnail_src+'"]');if(g.length>0)return g.trigger("click"),s.attr("current-image",a.image_id),void e.setTimeout(function(){t(e).trigger("resize"),n.trigger("woocommerce_gallery_init_zoom")},20);h.wc_set_variation_attr("src",a.image.src),h.wc_set_variation_attr("height",a.image.src_h),h.wc_set_variation_attr("width",a.image.src_w),h.wc_set_variation_attr("srcset",a.image.srcset),h.wc_set_variation_attr("sizes",a.image.sizes),h.wc_set_variation_attr("title",a.image.title),h.wc_set_variation_attr("data-caption",a.image.caption),h.wc_set_variation_attr("alt",a.image.alt),h.wc_set_variation_attr("data-src",a.image.full_src),h.wc_set_variation_attr("data-large_image",a.image.full_src),h.wc_set_variation_attr("data-large_image_width",a.image.full_src_w),h.wc_set_variation_attr("data-large_image_height",a.image.full_src_h),d.wc_set_variation_attr("data-thumb",a.image.src),l.wc_set_variation_attr("src",a.image.gallery_thumbnail_src),_.wc_set_variation_attr("href",a.image.full_src)}else s.wc_variations_image_reset();e.setTimeout(function(){t(e).trigger("resize"),s.wc_maybe_trigger_slide_position_reset(a),n.trigger("woocommerce_gallery_init_zoom")},20),t(i).on("wc_variation_form",function(t,e){new r(jQuery(t.target),e)})}})(jQuery,window,document);